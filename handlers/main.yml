---

- name: validate configuration
  ansible.builtin.command: |
    dnsmasq --test

- name: restart service
  ansible.builtin.service:
    name: dnsmasq
    state: restarted
  listen: restart dnsmasq
  when: service_default_state | default('started') == 'started'

- name: reload service
  ansible.builtin.service:
    name: dnsmasq
    state: reloaded
  listen: reload dnsmasq
  when: service_default_state | default('started') == 'started'

...
